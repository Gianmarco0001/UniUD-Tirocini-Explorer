<Window x:Class="UniUdTirocini.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        mc:Ignorable="d"
        Title="UniUD Tirocini Explorer" Height="850" Width="1200"
        Icon="pack://application:,,,/icona.ico"
        TextElement.Foreground="{DynamicResource MaterialDesignBody}"
        Background="{DynamicResource MaterialDesignPaper}"
        FontFamily="{DynamicResource MaterialDesignFont}">

    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <materialDesign:ColorZone Mode="PrimaryMid" Padding="20" materialDesign:ElevationAssist.Elevation="Dp4">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel>
                    <TextBlock Text="UniUD Tirocini" FontSize="28" FontWeight="Bold"/>
                    <TextBlock Text="Esplora le convenzioni attive" Opacity="0.8"/>
                </StackPanel>

                <StackPanel Grid.Column="1" Orientation="Horizontal">

                    <Button Click="BtnUpdate_Click" Style="{StaticResource MaterialDesignRaisedLightButton}" 
                            ToolTip="Carica file .xlsx o .csv aggiornato">
                        <StackPanel Orientation="Horizontal">
                            <materialDesign:PackIcon Kind="CloudUpload" VerticalAlignment="Center" Margin="0,0,8,0"/>
                            <TextBlock Text="AGGIORNA LISTA"/>
                        </StackPanel>
                    </Button>

                    <Button Style="{StaticResource MaterialDesignIconButton}" 
                            ToolTip="Info &amp; Credits" 
                            Click="BtnAbout_Click"
                            Foreground="White" 
                            Margin="10,0,0,0">
                        <materialDesign:PackIcon Kind="InformationOutline" Width="28" Height="28" />
                    </Button>
                </StackPanel>
            </Grid>
        </materialDesign:ColorZone>

        <Border Grid.Row="1" Padding="20" Background="#F5F5F5">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="2*"/>
                    <ColumnDefinition Width="3*"/>
                </Grid.ColumnDefinitions>

                <TextBox x:Name="TxtSearch" 
                         TextChanged="FiltraDati"
                         materialDesign:HintAssist.Hint="Cerca azienda, città, settore..."
                         Style="{StaticResource MaterialDesignOutlinedTextBox}"
                         FontSize="16" Margin="0,0,20,0"
                         Background="White"/>

                <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center">

                    <ToggleButton x:Name="TogFav" Style="{StaticResource MaterialDesignActionToggleButton}" 
                                  ToolTip="Mostra solo Preferiti" Click="FiltraDati" Margin="0,0,20,0">
                        <materialDesign:PackIcon Kind="Heart" Foreground="#E91E63" />
                    </ToggleButton>

                    <TextBlock Text="Filtra per:" VerticalAlignment="Center" FontWeight="Bold" Margin="0,0,10,0"/>
                    <CheckBox x:Name="ChkIng" Content="ING" Click="FiltraDati" Margin="5"/>
                    <CheckBox x:Name="ChkEco" Content="ECO" Click="FiltraDati" Margin="5"/>
                    <CheckBox x:Name="ChkMat" Content="MAT/INFO" Click="FiltraDati" Margin="5"/>
                    <CheckBox x:Name="ChkLin" Content="LINGUE" Click="FiltraDati" Margin="5"/>
                    <CheckBox x:Name="ChkGiu" Content="GIURI" Click="FiltraDati" Margin="5"/>
                </StackPanel>
            </Grid>
        </Border>

        <ListBox x:Name="ListAziende" Grid.Row="2" 
                 ScrollViewer.HorizontalScrollBarVisibility="Disabled" 
                 Padding="10" Background="#ECEFF1">

            <ListBox.ItemsPanel>
                <ItemsPanelTemplate>
                    <VirtualizingStackPanel />
                </ItemsPanelTemplate>
            </ListBox.ItemsPanel>

            <ListBox.ItemTemplate>
                <DataTemplate>
                    <materialDesign:Card Margin="5" Padding="0" UniformCornerRadius="8" Width="950">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="80"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <Border Background="{DynamicResource PrimaryHueLightBrush}" CornerRadius="8,0,0,8">
                                <TextBlock Text="{Binding Iniziale}" HorizontalAlignment="Center" VerticalAlignment="Center" 
                                           FontSize="32" FontWeight="Bold" Foreground="{DynamicResource PrimaryHueMidForegroundBrush}"/>
                            </Border>

                            <StackPanel Grid.Column="1" Margin="15,10" VerticalAlignment="Center">
                                <TextBlock Text="{Binding Nome}" FontSize="18" FontWeight="Bold" TextTrimming="CharacterEllipsis"/>

                                <StackPanel Orientation="Horizontal" Margin="0,4">
                                    <materialDesign:PackIcon Kind="MapMarker" Foreground="Gray" VerticalAlignment="Center"/>
                                    <TextBlock Text="{Binding LuogoCompleto}" Foreground="Gray" Margin="5,0,15,0"/>
                                    <materialDesign:PackIcon Kind="Domain" Foreground="Gray" VerticalAlignment="Center"/>
                                    <TextBlock Text="{Binding Settore}" Foreground="Gray" Margin="5,0" TextTrimming="CharacterEllipsis" MaxWidth="350"/>
                                </StackPanel>

                                <StackPanel Orientation="Horizontal" Margin="0,5,0,0">
                                    <Border Background="#1976D2" CornerRadius="4" Padding="6,2" Margin="0,0,5,0" Visibility="{Binding IsIng, Converter={StaticResource BooleanToVisibilityConverter}}">
                                        <TextBlock Text="ING" Foreground="White" FontSize="10" FontWeight="Bold"/>
                                    </Border>
                                    <Border Background="#388E3C" CornerRadius="4" Padding="6,2" Margin="0,0,5,0" Visibility="{Binding IsEco, Converter={StaticResource BooleanToVisibilityConverter}}">
                                        <TextBlock Text="ECO" Foreground="White" FontSize="10" FontWeight="Bold"/>
                                    </Border>
                                    <Border Background="#7B1FA2" CornerRadius="4" Padding="6,2" Margin="0,0,5,0" Visibility="{Binding IsMatInfo, Converter={StaticResource BooleanToVisibilityConverter}}">
                                        <TextBlock Text="MAT/INFO" Foreground="White" FontSize="10" FontWeight="Bold"/>
                                    </Border>
                                    <Border Background="#FBC02D" CornerRadius="4" Padding="6,2" Margin="0,0,5,0" Visibility="{Binding IsLin, Converter={StaticResource BooleanToVisibilityConverter}}">
                                        <TextBlock Text="LIN" Foreground="Black" FontSize="10" FontWeight="Bold"/>
                                    </Border>
                                    <Border Background="#D32F2F" CornerRadius="4" Padding="6,2" Margin="0,0,5,0" Visibility="{Binding IsGiu, Converter={StaticResource BooleanToVisibilityConverter}}">
                                        <TextBlock Text="GIURI" Foreground="White" FontSize="10" FontWeight="Bold"/>
                                    </Border>
                                </StackPanel>
                            </StackPanel>

                            <StackPanel Grid.Column="2" Orientation="Vertical" VerticalAlignment="Center" Margin="10">

                                <Button Style="{StaticResource MaterialDesignIconButton}" Click="BtnFavorite_Click" ToolTip="Aggiungi/Rimuovi Preferiti">
                                    <materialDesign:PackIcon Kind="{Binding FavoriteIcon}" Foreground="{Binding FavoriteColor}" Width="24" Height="24"/>
                                </Button>

                                <StackPanel Orientation="Horizontal">
                                    <Button Style="{StaticResource MaterialDesignIconButton}" ToolTip="Vedi su Mappa"
                                            CommandParameter="{Binding GoogleMapsUrl}" Click="BtnWeb_Click" Width="30" Height="30">
                                        <materialDesign:PackIcon Kind="GoogleMaps" Foreground="#34A853"/>
                                    </Button>

                                    <Button Style="{StaticResource MaterialDesignIconButton}" ToolTip="Scrivi Email"
                                            CommandParameter="{Binding Email}" Click="BtnEmail_Click" Width="30" Height="30">
                                        <materialDesign:PackIcon Kind="EmailOutline" />
                                    </Button>

                                    <Button Style="{StaticResource MaterialDesignIconButton}" ToolTip="Visita Sito"
                                            CommandParameter="{Binding Web}" Click="BtnWeb_Click" Width="30" Height="30">
                                        <materialDesign:PackIcon Kind="Web" />
                                    </Button>
                                </StackPanel>
                            </StackPanel>
                        </Grid>
                    </materialDesign:Card>
                </DataTemplate>
            </ListBox.ItemTemplate>
        </ListBox>
    </Grid>
</Window>